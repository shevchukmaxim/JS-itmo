<!DOCTYPE html>
<html lang="ru">
<head>
	<meta charset="UTF-8">
	<title>Принципы гештальта: 1 урок</title>
	<link href="style/style.css" rel="stylesheet">
	<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.0.10/css/all.css" integrity="sha384-+d0P83n9kaQMCwj8F4RJB66tzIwOKmrdb46+porD/OvrJ+37WqIM7UoBtwHO6Nlg" crossorigin="anonymous">
	
</head>
<body>
	<header class="page-header">
		<p>Задание 1</p>
	</header>
	<div class="main">
		<div id="theory">
			<div class="theory-header">
				<p class="theory-label">Теория</p>
				<button class="hide-button" id="hide-buttn"><i id="arrow"></i></button>
			</div>
			<div class="theory-content">
				<h3>Принцип №1: Фигура-Фон </h3>
				<p>Идея состоит в том, что глаз будет отделять целые рисунки на фоне, чтобы понять увиденное
				</p>
				<img src="img/task01.jpg" alt="" width="100%">
				<p>На изображении выше мгновенно распознается белое яблоко на черном фоне</p>
			</div>
		</div>
		<div id="editor-block">
			<div class="editor-header">
				<p class="editor-header-tab">index.html</p>
			</div>
			<div class="editor-body">
				<pre id="editor"></pre>
			</div>
		</div>
		<div id="browser">
			<div class="browser-header">
				<p class="browser-label">Результат</p>
			</div>
			<iframe id="myframe" class="browser-iframe" name="listenMsg" src="iframes/lesson01-iframe.html" frameborder="0" >
			</iframe>
		</div>	
	</div>
	<footer class="page-footer">
		<div class="page-control">
			<a href="theory.html" class="control-btn prev">Назад</a>
			<input id="btn-Preview-Image" type="button" value="Проверить"/>
			<a href="#" class="control-btn next">Вперед</a>
			
		</div>
	</footer>
	
	<div id="answer">
		<iframe id="myframe-key" class="browser-iframe" name="listenMsg" src="iframes/lesson01-iframe-key.html" frameborder="0" >
		</iframe>
	</div>

	<script src="http://code.jquery.com/jquery-latest.min.js"></script>
	<script src="script/script.js"></script>
	<!--ACE-->
	<!-- load emmet code and snippets compiled for browser -->
	<script src="https://cloud9ide.github.io/emmet-core/emmet.js"></script>
	
	<!-- load ace -->
	<script src="./ace-builds/src/ace.js"></script>
	<!--load ace emmet extension-->
	<script src="./ace-builds/src/ext-emmet.js"></script>
	<!--ace into iframe-->
	<script src="script/aceframe.js" type="text/javascript"></script>
	
	<script src="https://files.codepedia.info/files/uploads/iScripts/html2canvas.js"></script>
	
	<script src="rembrandt/browser.min.js"></script>
	

	<script>
		$(document).ready(function(){

			var answer = $("#myframe");
			var key = $("#myframe-key");
			var imgAnswer;
			var imgKey;

			html2canvas(answer, {
         		onrendered: function (canvas) {
                	window.imgAnswer = canvas.toDataURL();
             		}
         	});
         	html2canvas(key, {
         		onrendered: function (canvas) {
                	window.imgKey = canvas.toDataURL();
             		}
         	});

		    $("#btn-Preview-Image").on('click', function () {
         		html2canvas(answer, {
         		onrendered: function (canvas) {
                	window.imgAnswer = canvas.toDataURL();
             		}
         		});
         		html2canvas(key, {
         		onrendered: function (canvas) {
                	window.imgKey = canvas.toDataURL();
                	
             		}
         		});
	    		window.open(window.imgAnswer); 
	    		window.open(window.imgKey); 	

				const rembrandt = new Rembrandt({
				  // `imageA` and `imageB` can be either Strings (file path on node.js,
				  // public url on Browsers) or Buffers
				  imageA: window.imgAnswer,
				  imageB: window.imgKey,

				  // Needs to be one of Rembrandt.THRESHOLD_PERCENT or Rembrandt.THRESHOLD_PIXELS
				  thresholdType: Rembrandt.THRESHOLD_PERCENT,

				  // The maximum threshold (0...1 for THRESHOLD_PERCENT, pixel count for THRESHOLD_PIXELS
				  maxThreshold: 0,

				  // Maximum color delta (0...255):
				  maxDelta: 15,

				  // Maximum surrounding pixel offset
				  maxOffset: 0,

				  renderComposition: true, // Should Rembrandt render a composition image?
				  compositionMaskColor: Rembrandt.Color.RED // Color of unmatched pixels
				});

				// Run the comparison
				rembrandt.compare()
				  .then(function (result) {
				    console.log('Passed:', result.passed)
				    console.log('Pixel Difference:', result.differences, 'Percentage Difference', result.percentageDifference, '%')
				    console.log('Composition image buffer:', result.compositionImage)

				    // Note that `compositionImage` is an Image when Rembrandt.js is run in the browser environment
				  })
				  .catch((e) => {
				    console.error(e)
				  });
		  	});
		});  
	</script>
</body>
</html>